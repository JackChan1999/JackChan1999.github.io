<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="泛型," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="1. 泛型概述泛型（Generic type 或者 generics）是对 Java 语言的类型系统的一种扩展，以支持创建可以按类型进行参数化的类。可以把类型参数看作是使用参数化类型时指定的类型的一个占位符，就像方法的形式参数是运行时传递的值的占位符一样。 泛型是Java SE 1.5的新特性，泛型的本质是参数化类型，也就是说所操作的数据类型被指定为一个参数。这种参数类型可以用在类、接口和方法的创">
<meta name="keywords" content="泛型">
<meta property="og:type" content="article">
<meta property="og:title" content="泛型">
<meta property="og:url" content="http://yoursite.com/2017/04/30/泛型/index.html">
<meta property="og:site_name" content="秋过冬漫长">
<meta property="og:description" content="1. 泛型概述泛型（Generic type 或者 generics）是对 Java 语言的类型系统的一种扩展，以支持创建可以按类型进行参数化的类。可以把类型参数看作是使用参数化类型时指定的类型的一个占位符，就像方法的形式参数是运行时传递的值的占位符一样。 泛型是Java SE 1.5的新特性，泛型的本质是参数化类型，也就是说所操作的数据类型被指定为一个参数。这种参数类型可以用在类、接口和方法的创">
<meta property="og:updated_time" content="2017-05-01T02:30:19.282Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="泛型">
<meta name="twitter:description" content="1. 泛型概述泛型（Generic type 或者 generics）是对 Java 语言的类型系统的一种扩展，以支持创建可以按类型进行参数化的类。可以把类型参数看作是使用参数化类型时指定的类型的一个占位符，就像方法的形式参数是运行时传递的值的占位符一样。 泛型是Java SE 1.5的新特性，泛型的本质是参数化类型，也就是说所操作的数据类型被指定为一个参数。这种参数类型可以用在类、接口和方法的创">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/04/30/泛型/"/>





  <title>泛型 | 秋过冬漫长</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">秋过冬漫长</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">没有比脚更长的路，走过去，前面是个天！</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/30/泛型/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JackChan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/ai.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="秋过冬漫长">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                泛型
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-30T23:55:59+08:00">
                2017-04-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/04/30/泛型/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/04/30/泛型/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="1-泛型概述"><a href="#1-泛型概述" class="headerlink" title="1. 泛型概述"></a>1. 泛型概述</h2><p>泛型（Generic type 或者 generics）是对 Java 语言的类型系统的一种扩展，以支持创建可以按类型进行参数化的类。可以把类型参数看作是使用参数化类型时指定的类型的一个占位符，就像方法的形式参数是运行时传递的值的占位符一样。</p>
<p>泛型是Java SE 1.5的新特性，泛型的本质是参数化类型，也就是说所操作的数据类型被指定为一个参数。这种参数类型可以用在类、接口和方法的创建中，分别称为泛型类、泛型接口、泛型方法。 Java语言引入泛型的好处是安全简单。</p>
<p>在Java SE 1.5之前，没有泛型的情况的下，通过对类型Object的引用来实现参数的“任意化”，“任意化”带来的缺点是要做显式的强制类型转换，而这种转换是要求开发者对实际参数类型可以预知的情况下进行的。对于强制类型转换错误的情况，编译器可能不提示错误，在运行的时候才出现异常，这是一个安全隐患。</p>
<p>泛型的好处是在编译的时候检查类型安全，并且所有的强制转换都是自动和隐式的，以提高代码的重用率。</p>
<p>可以在集合框架（Collection framework）中看到泛型的动机。例如，Map 类允许您向一个 Map添加任意类的对象，即使最常见的情况是在给定映射（map）中保存某个特定类型（比如 String）的对象。</p>
<a id="more"></a>
<p>因为 Map.get() 被定义为返回 Object，所以一般必须将 Map.get() 的结果强制类型转换为期望的类型，如下面的代码所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Map m = <span class="keyword">new</span> HashMap();</div><div class="line">m.put(<span class="string">"key"</span>, <span class="string">"blarg"</span>);</div><div class="line">String s = (String) m.get(<span class="string">"key"</span>);</div></pre></td></tr></table></figure>
<p>要让程序通过编译，必须将 get() 的结果强制类型转换为 String，并且希望结果真的是一个 String。但是有可能某人已经在该映射中保存了不是 String 的东西，这样的话，上面的代码将会抛出 ClassCastException。</p>
<p>理想情况下，您可能会得出这样一个观点，即 m 是一个 Map，它将 String 键映射到 String 值。这可以让您消除代码中的强制类型转换，同时获得一个附加的类型检查层，该检查层可以防止有人将错误类型的键或值保存在集合中。这就是泛型所做的工作。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cn.itcast_01;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.Iterator;</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"> * ArrayList存储字符串并遍历</div><div class="line"> * </div><div class="line"> * 我们按照正常的写法来写这个程序， 结果确出错了。</div><div class="line"> * 为什么呢?</div><div class="line"> * 		因为我们开始存储的时候，存储了String和Integer两种类型的数据。</div><div class="line"> * 		而在遍历的时候，我们把它们都当作String类型处理的，做了转换，所以就报错了。</div><div class="line"> * 但是呢，它在编译期间却没有告诉我们。</div><div class="line"> * 所以，我就觉得这个设计的不好。</div><div class="line"> * 回想一下，我们的数组</div><div class="line"> * 		String[] strArray = new String[3];</div><div class="line"> * 		strArray[0] = "hello";</div><div class="line"> * 		strArray[1] = "world";</div><div class="line"> * 		strArray[2] = 10;</div><div class="line"> * 集合也模仿着数组的这种做法，在创建对象的时候明确元素的数据类型。这样就不会在有问题了。</div><div class="line"> * 而这种技术被称为：泛型。</div><div class="line"> * </div><div class="line"> * 泛型：是一种把类型明确的工作推迟到创建对象或者调用方法的时候才去明确的特殊的类型。参数化类型，把类型当作参数一样的传递。</div><div class="line"> * 格式：</div><div class="line"> * 		&lt;数据类型&gt;</div><div class="line"> * 		此处的数据类型只能是引用类型。</div><div class="line"> * 好处：</div><div class="line"> * 		A:把运行时期的问题提前到了编译期间</div><div class="line"> * 		B:避免了强制类型转换</div><div class="line"> * 		C:优化了程序设计，解决了黄色警告线</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericDemo</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		<span class="comment">// 创建</span></div><div class="line">		ArrayList&lt;String&gt; array = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line"></div><div class="line">		<span class="comment">// 添加元素</span></div><div class="line">		array.add(<span class="string">"hello"</span>);</div><div class="line">		array.add(<span class="string">"world"</span>);</div><div class="line">		array.add(<span class="string">"java"</span>);</div><div class="line">		<span class="comment">// array.add(new Integer(100));</span></div><div class="line">		<span class="comment">//array.add(10); // JDK5以后的自动装箱</span></div><div class="line">		<span class="comment">// 等价于：array.add(Integer.valueOf(10));</span></div><div class="line"></div><div class="line">		<span class="comment">// 遍历</span></div><div class="line">		Iterator&lt;String&gt; it = array.iterator();</div><div class="line">		<span class="keyword">while</span> (it.hasNext()) &#123;</div><div class="line">			<span class="comment">// ClassCastException</span></div><div class="line">			<span class="comment">// String s = (String) it.next();</span></div><div class="line">			String s = it.next();</div><div class="line">			System.out.println(s);</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="comment">// 看下面这个代码</span></div><div class="line">		<span class="comment">// String[] strArray = new String[3];</span></div><div class="line">		<span class="comment">// strArray[0] = "hello";</span></div><div class="line">		<span class="comment">// strArray[1] = "world";</span></div><div class="line">		<span class="comment">// strArray[2] = 10;</span></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="2-泛型的好处"><a href="#2-泛型的好处" class="headerlink" title="2. 泛型的好处"></a>2. 泛型的好处</h2><p>Java 语言中引入泛型是一个较大的功能增强。不仅语言、类型系统和编译器有了较大的变化，以支持泛型，而且类库也进行了大翻修，所以许多重要的类，比如集合框架，都已经成为泛型化的了。这带来了很多好处：</p>
<h3 id="2-1-类型安全"><a href="#2-1-类型安全" class="headerlink" title="2.1 类型安全"></a>2.1 类型安全</h3><p>泛型的主要目标是提高 Java 程序的类型安全。通过知道使用泛型定义的变量的类型限制，编译器可以在一个高得多的程度上验证类型假设。没有泛型，这些假设就只存在于程序员的头脑中（或者如果幸运的话，还存在于代码注释中）。</p>
<p>Java 程序中的一种流行技术是定义这样的集合，即它的元素或键是公共类型的，比如“String 列表”或者“String 到 String 的映射”。通过在变量声明中捕获这一附加的类型信息，泛型允许编译器实施这些附加的类型约束。类型错误现在就可以在编译时被捕获了，而不是在运行时当作 ClassCastException 展示出来。将类型检查从运行时挪到编译时有助于您更容易找到错误，并可提高程序的可靠性。</p>
<h3 id="2-2-消除强制类型转换"><a href="#2-2-消除强制类型转换" class="headerlink" title="2.2  消除强制类型转换"></a>2.2  消除强制类型转换</h3><p>泛型的一个附带好处是，消除源代码中的许多强制类型转换。这使得代码更加可读，并且减少了出错机会。<br>尽管减少强制类型转换可以降低使用泛型类的代码的罗嗦程度，但是声明泛型变量会带来相应的罗嗦。</p>
<h3 id="2-3-优化了程序设计，解决了黄色警告线"><a href="#2-3-优化了程序设计，解决了黄色警告线" class="headerlink" title="2.3 优化了程序设计，解决了黄色警告线"></a>2.3 优化了程序设计，解决了黄色警告线</h3><h2 id="3-泛型的应用"><a href="#3-泛型的应用" class="headerlink" title="3. 泛型的应用"></a>3. 泛型的应用</h2><h3 id="3-1-泛型的内部原理"><a href="#3-1-泛型的内部原理" class="headerlink" title="3.1 泛型的内部原理"></a>3.1 泛型的内部原理</h3><p>泛型是提供给javac编译器使用的，可以限定集合中的输入类型，让编译器挡住源程序中的非法输入。但是，编译器编译带类型说明的集合时会去除掉“类型”信息，目的就是使程序运行效率不受影响。因此，对于参数化的泛型类型，getClass()方法的返回值和原始类型完全一样。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.itheima.day2;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericTest</span> </span>&#123;</div><div class="line">      </div><div class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">            ArrayList&lt;String&gt; collection1 = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">            ArrayList collection2 = <span class="keyword">new</span> ArrayList();</div><div class="line">            System. out.println(collection1.getClass() == collection2.getClass());</div><div class="line">             <span class="comment">//结果：true</span></div><div class="line">      &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>由于编译生成的字节码会去掉泛型的类型信息，只要能跳过编译器，就可以往某个泛型集合中加入其它类型的数据，例如，用反射得到集合，再调用其add方法即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.itheima.day2;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericTest</span> </span>&#123;</div><div class="line">      </div><div class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">            ArrayList&lt;Integer&gt; collection1 = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</div><div class="line">            collection1.getClass().getMethod( <span class="string">"add"</span>,Object.class).invoke(collection1, <span class="string">"abc"</span>);</div><div class="line">            System. out.println(collection1.get(<span class="number">0</span>));</div><div class="line">      &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ArrayList<e>类定义和ArrayList<integer>类引用中涉及如下术语：</integer></e></p>
<ul>
<li>整个称为ArrayList&lt;E&gt;泛型类型</li>
<li>ArrayList&lt;E&gt;中的E称为类型变量或类型参数</li>
<li>整个ArrayList&lt;Integer&gt;称为参数化的类型</li>
<li>ArrayList&lt;Integer&gt;中的Integer称为类型参数的实例或实际类型参数</li>
<li>ArrayList&lt;Integer&gt;中的&lt;&gt;念着typeof</li>
<li>ArrayList称为原始类型</li>
</ul>
<p>参数化类型与原始类型的兼容性：参数化类型可以引用一个原始类型的对象，编译报告警告，例如</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Collection&lt;String&gt; c = <span class="keyword">new</span> Vector();<span class="comment">//考虑到对以前代码的兼容性，编译器是可以通过的</span></div></pre></td></tr></table></figure>
<p>原始类型可以引用一个参数化类型的对象，编译报告警告，例如<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Collection c = <span class="keyword">new</span> Vector&lt;String&gt;();<span class="comment">//原来的方法接受一个集合参数，新的类型也要能传进去</span></div></pre></td></tr></table></figure></p>
<p>参数化类型不考虑类型参数的继承关系：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Vector&lt;String&gt; v = <span class="keyword">new</span> Vector&lt;Object&gt;(); <span class="comment">//错误!不写&lt;Object&gt;没错，写了就是明知故犯</span></div><div class="line">Vector&lt;Object&gt; v = <span class="keyword">new</span> Vector&lt;String&gt;(); <span class="comment">//也错误!</span></div></pre></td></tr></table></figure>
<p>注意： </p>
<p>假设Vector&lt;String&gt; v = new Vector&lt;Object&gt;();可以的话，那么以后从v中取出的对象当作String用，而v实际指向的对象中可以加入任意的类型对象；</p>
<p>假设Vector&lt;Object&gt; v = new Vector&lt;String&gt;();可以的话，那么以后可以向v中加入任意的类型对象，而v实际指向的集合中只能装String类型的对象。</p>
<p>编译器不允许创建泛型变量的数组。即在创建数组实例时，数组的元素不能使用参数化的类型。</p>
<p>例如，下面语句有错误：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Vector&lt;Integer&gt; vectorList[] = <span class="keyword">new</span> Vector&lt;Integer&gt;[<span class="number">10</span>];</div></pre></td></tr></table></figure>
<p>思考题：</p>
<p>下面的代码会报错误吗？</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Vector v1 = <span class="keyword">new</span> Vector&lt;String&gt;();</div><div class="line">Vector&lt;Object&gt; v = v1;</div></pre></td></tr></table></figure>
<p>答案：编译的时候是不会报错的，因为编译器是一行一行按照语法检查代码的，因此不会出错。</p>
<h2 id="4-泛型类"><a href="#4-泛型类" class="headerlink" title="4. 泛型类"></a>4. 泛型类</h2><p>把泛型定义在类上，格式:public class 类名&lt;泛型类型1,…&gt;，注意:泛型类型必须是引用类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cn.itcast_04;</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"> * 泛型类的测试</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectToolDemo</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		<span class="comment">// ObjectTool ot = new ObjectTool();</span></div><div class="line">		<span class="comment">//</span></div><div class="line">		<span class="comment">// ot.setObj(new String("风清扬"));</span></div><div class="line">		<span class="comment">// String s = (String) ot.getObj();</span></div><div class="line">		<span class="comment">// System.out.println("姓名是：" + s);</span></div><div class="line">		<span class="comment">//</span></div><div class="line">		<span class="comment">// ot.setObj(new Integer(30));</span></div><div class="line">		<span class="comment">// Integer i = (Integer) ot.getObj();</span></div><div class="line">		<span class="comment">// System.out.println("年龄是：" + i);</span></div><div class="line"></div><div class="line">		<span class="comment">// ot.setObj(new String("林青霞"));</span></div><div class="line">		<span class="comment">// // ClassCastException</span></div><div class="line">		<span class="comment">// Integer ii = (Integer) ot.getObj();</span></div><div class="line">		<span class="comment">// System.out.println("姓名是：" + ii);</span></div><div class="line"></div><div class="line">		System.out.println(<span class="string">"-------------"</span>);</div><div class="line"></div><div class="line">		ObjectTool&lt;String&gt; ot = <span class="keyword">new</span> ObjectTool&lt;String&gt;();</div><div class="line">		<span class="comment">// ot.setObj(new Integer(27)); //这个时候编译期间就过不去</span></div><div class="line">		ot.setObj(<span class="keyword">new</span> String(<span class="string">"林青霞"</span>));</div><div class="line">		String s = ot.getObj();</div><div class="line">		System.out.println(<span class="string">"姓名是："</span> + s);</div><div class="line"></div><div class="line">		ObjectTool&lt;Integer&gt; ot2 = <span class="keyword">new</span> ObjectTool&lt;Integer&gt;();</div><div class="line">		<span class="comment">// ot2.setObj(new String("风清扬"));//这个时候编译期间就过不去</span></div><div class="line">		ot2.setObj(<span class="keyword">new</span> Integer(<span class="number">27</span>));</div><div class="line">		Integer i = ot2.getObj();</div><div class="line">		System.out.println(<span class="string">"年龄是："</span> + i);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//泛型类：把泛型定义在类上</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ObjectTool</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line">	<span class="keyword">private</span> T obj;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> T <span class="title">getObj</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> obj;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setObj</span><span class="params">(T obj)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.obj = obj;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="5-泛型方法"><a href="#5-泛型方法" class="headerlink" title="5. 泛型方法"></a>5. 泛型方法</h2><p>把泛型定义在方法上，格式:public &lt;泛型类型&gt; 返回类型 方法名(泛型类型 .)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cn.itcast_05;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectToolDemo</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		<span class="comment">// ObjectTool ot = new ObjectTool();</span></div><div class="line">		<span class="comment">// ot.show("hello");</span></div><div class="line">		<span class="comment">// ot.show(100);</span></div><div class="line">		<span class="comment">// ot.show(true);</span></div><div class="line"></div><div class="line">		<span class="comment">// ObjectTool&lt;String&gt; ot = new ObjectTool&lt;String&gt;();</span></div><div class="line">		<span class="comment">// ot.show("hello");</span></div><div class="line">		<span class="comment">//</span></div><div class="line">		<span class="comment">// ObjectTool&lt;Integer&gt; ot2 = new ObjectTool&lt;Integer&gt;();</span></div><div class="line">		<span class="comment">// ot2.show(100);</span></div><div class="line">		<span class="comment">//</span></div><div class="line">		<span class="comment">// ObjectTool&lt;Boolean&gt; ot3 = new ObjectTool&lt;Boolean&gt;();</span></div><div class="line">		<span class="comment">// ot3.show(true);</span></div><div class="line"></div><div class="line">		<span class="comment">// 定义泛型方法后</span></div><div class="line">		ObjectTool ot = <span class="keyword">new</span> ObjectTool();</div><div class="line">		ot.show(<span class="string">"hello"</span>);</div><div class="line">		ot.show(<span class="number">100</span>);</div><div class="line">		ot.show(<span class="keyword">true</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//泛型方法：把泛型定义在方法上</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ObjectTool</span> </span>&#123;</div><div class="line">	<span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(T t)</span> </span>&#123;</div><div class="line">		System.out.println(t);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="6-泛型接口"><a href="#6-泛型接口" class="headerlink" title="6. 泛型接口"></a>6. 泛型接口</h2><p>把泛型定义在接口上，格式:public  interface 接口名&lt;泛型类型1…&gt;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cn.itcast_06;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InterDemo</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		<span class="comment">// 第一种情况的测试</span></div><div class="line">		<span class="comment">// Inter&lt;String&gt; i = new InterImpl();</span></div><div class="line">		<span class="comment">// i.show("hello");</span></div><div class="line"></div><div class="line">		<span class="comment">// // 第二种情况的测试</span></div><div class="line">		Inter&lt;String&gt; i = <span class="keyword">new</span> InterImpl&lt;String&gt;();</div><div class="line">		i.show(<span class="string">"hello"</span>);</div><div class="line"></div><div class="line">		Inter&lt;Integer&gt; ii = <span class="keyword">new</span> InterImpl&lt;Integer&gt;();</div><div class="line">		ii.show(<span class="number">100</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//泛型接口：把泛型定义在接口上 </span></div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Inter</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">(T t)</span></span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">// 实现类在实现接口的时候</span></div><div class="line"><span class="comment">// 第一种情况：已经知道该是什么类型的了</span></div><div class="line"></div><div class="line"><span class="comment">//public class InterImpl implements Inter&lt;String&gt; &#123;</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//	@Override</span></div><div class="line"><span class="comment">//	public void show(String t) &#123;</span></div><div class="line"><span class="comment">//		System.out.println(t);</span></div><div class="line"><span class="comment">//	&#125;</span></div><div class="line"><span class="comment">// &#125;</span></div><div class="line"></div><div class="line"><span class="comment">// 第二种情况：还不知道是什么类型的</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">InterImpl</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">Inter</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">(T t)</span> </span>&#123;</div><div class="line">		System.out.println(t);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="7-泛型高级-通配符"><a href="#7-泛型高级-通配符" class="headerlink" title="7. 泛型高级(通配符)"></a>7. 泛型高级(通配符)</h2><p>为了解决类型被限制死了不能动态根据实例来确定的缺点，引入了“通配符泛型”，针对上面的例子，使用通配泛型格式为&lt;? extends Collection&gt;，“？”代表未知类型，这个类型是实现Collection接口。? extends E：向下限定，E及其子类，限定通配符的上边界。? super E：向上限定，E及其父类，限定通配符的下边界。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cn.itcast_07;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.Collection;</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"> * 泛型高级(通配符)</div><div class="line"> * ?:任意类型，如果没有明确，那么就是Object以及任意的Java类了</div><div class="line"> * ? extends E:向下限定，E及其子类</div><div class="line"> * ? super E:向上限定，E极其父类</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericDemo</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		<span class="comment">// 泛型如果明确的写的时候，前后必须一致</span></div><div class="line">		Collection&lt;Object&gt; c1 = <span class="keyword">new</span> ArrayList&lt;Object&gt;();</div><div class="line">		<span class="comment">// Collection&lt;Object&gt; c2 = new ArrayList&lt;Animal&gt;();</span></div><div class="line">		<span class="comment">// Collection&lt;Object&gt; c3 = new ArrayList&lt;Dog&gt;();</span></div><div class="line">		<span class="comment">// Collection&lt;Object&gt; c4 = new ArrayList&lt;Cat&gt;();</span></div><div class="line"></div><div class="line">		<span class="comment">// ?表示任意的类型都是可以的</span></div><div class="line">		Collection&lt;?&gt; c5 = <span class="keyword">new</span> ArrayList&lt;Object&gt;();</div><div class="line">		Collection&lt;?&gt; c6 = <span class="keyword">new</span> ArrayList&lt;Animal&gt;();</div><div class="line">		Collection&lt;?&gt; c7 = <span class="keyword">new</span> ArrayList&lt;Dog&gt;();</div><div class="line">		Collection&lt;?&gt; c8 = <span class="keyword">new</span> ArrayList&lt;Cat&gt;();</div><div class="line"></div><div class="line">		<span class="comment">// ? extends E:向下限定，E及其子类</span></div><div class="line">		<span class="comment">// Collection&lt;? extends Animal&gt; c9 = new ArrayList&lt;Object&gt;();</span></div><div class="line">		Collection&lt;? extends Animal&gt; c10 = <span class="keyword">new</span> ArrayList&lt;Animal&gt;();</div><div class="line">		Collection&lt;? extends Animal&gt; c11 = <span class="keyword">new</span> ArrayList&lt;Dog&gt;();</div><div class="line">		Collection&lt;? extends Animal&gt; c12 = <span class="keyword">new</span> ArrayList&lt;Cat&gt;();</div><div class="line"></div><div class="line">		<span class="comment">// ? super E:向上限定，E极其父类</span></div><div class="line">		Collection&lt;? <span class="keyword">super</span> Animal&gt; c13 = <span class="keyword">new</span> ArrayList&lt;Object&gt;();</div><div class="line">		Collection&lt;? <span class="keyword">super</span> Animal&gt; c14 = <span class="keyword">new</span> ArrayList&lt;Animal&gt;();</div><div class="line">		<span class="comment">// Collection&lt;? super Animal&gt; c15 = new ArrayList&lt;Dog&gt;();</span></div><div class="line">		<span class="comment">// Collection&lt;? super Animal&gt; c16 = new ArrayList&lt;Cat&gt;();</span></div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h2><p>泛型是提供给javac编译器使用的，可以限定集合中的输入类型，让编译器挡住源程序中的非法输入，编译器编译带类型说明的集合时会去除掉“类型”信息，使程序运行效率不受影响，对于参数化的泛型类型，getClass()方法的返回值和原始类型完全一样。由于编译生成的字节码会去掉泛型的类型信息，只要能跳过编译器，就可以往某个泛型集合中加入其它类型的数据，例如，用反射得到集合，再调用其add方法即可。</p>
<p>泛型引用和创建两端，给出的泛型变量必须相同</p>
<h2 id="泛型类"><a href="#泛型类" class="headerlink" title="泛型类"></a>泛型类</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">A&lt;T&gt;</div><div class="line">Class&lt;T&gt; type</div></pre></td></tr></table></figure>
<p>泛型类中使用泛型</p>
<ul>
<li>成员类型</li>
<li>返回值和参数类型</li>
<li>局部变量的引用上</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line">    <span class="keyword">private</span> T bean;<span class="comment">//泛型可在成员变量上使用</span></div><div class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">fun</span><span class="params">(T t)</span> </span>&#123;&#125;<span class="comment">//泛型可以在类中的方法上（返回值和参数类型）使用！</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fun2</span><span class="params">()</span> </span>&#123;<span class="comment">//泛型还可以在局部变量的引用类型上使用</span></div><div class="line">        T b = ...</div><div class="line">        <span class="keyword">new</span> T();<span class="comment">//不行的！</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="泛型方法"><a href="#泛型方法" class="headerlink" title="泛型方法"></a>泛型方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">add</span><span class="params">(T x, T y)</span></span>&#123; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>泛型方法与泛型类没有什么关系，泛型方法不一定非要在泛型类中！</p>
<h2 id="泛型的继承和实现"><a href="#泛型的继承和实现" class="headerlink" title="泛型的继承和实现"></a>泛型的继承和实现</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// AA不是泛型类，只是它爸爸是泛型类！</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AA</span> <span class="keyword">extends</span> <span class="title">A</span>&lt;<span class="title">String</span>&gt; </span>&#123;</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>继承泛型类</p>
<ul>
<li>子类不是泛型类：需要给父类传递类型常量</li>
</ul>
<p>当给父类传递的类型常量为String时，那么在父类中所有T都会被String替换！</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AA1</span> <span class="keyword">extends</span> <span class="title">A</span>&lt;<span class="title">String</span>&gt; </span>&#123;</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>子类是泛型类：可以给父类传递类型常量，也可以传递类型变量</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AA3</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">A</span>&lt;<span class="title">E</span>&gt; </span>&#123;</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h2><ul>
<li>无限通配符&lt;?&gt;</li>
<li>向下通配符&lt;? extends T&gt;</li>
<li>向上通配符&lt;? super T&gt;</li>
</ul>
<h2 id="类型推断"><a href="#类型推断" class="headerlink" title="类型推断"></a>类型推断</h2><ul>
<li>通过反射的方式获取泛型的实际类型</li>
<li>泛型只能是引用类型，不能是基本数据类型</li>
</ul>
<h2 id="泛型擦除"><a href="#泛型擦除" class="headerlink" title="泛型擦除"></a>泛型擦除</h2><p>泛型会在编译时擦除，List<string>和List<user>这两个的字节码文件那一个都是List.class</user></string></p>
<h2 id="Gson泛型封装"><a href="#Gson泛型封装" class="headerlink" title="Gson泛型封装"></a>Gson泛型封装</h2><p>在<a href="http://www.jianshu.com/p/e740196225a4" target="_blank" rel="external">你真的会用Gson吗?Gson使用指南（一）</a> 的第三节我介绍了在Gson中如何使用泛型来简化我们的类设计，但随之而来引入了一个新的问题：封装。不知道各位有没有想过这样一个问题：每次都要用 <code>new TypeToken&lt;XXX&gt;(){};</code> 好麻烦，有没有更好的办法?</p>
<p>有更好的办法么?当然有！相信也有不少人自己作了尝试，只是有人欢喜有人愁了，不过没关系，今天我们就来解决这个问题。</p>
<h3 id="约定"><a href="#约定" class="headerlink" title="约定"></a>约定</h3><p>1、本文涉及到的json格式</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// data 为 object 的情况</div><div class="line">&#123;"code":"0","message":"success","data":&#123;&#125;&#125;</div><div class="line">// data 为 array 的情况</div><div class="line">&#123;"code":"0","message":"success","data":[]&#125;</div></pre></td></tr></table></figure>
<p>2、假定第一种的对应的Java类型为 <code>Result&lt;XXX&gt;</code> ，第二种为 <code>Result&lt;List&lt;XXX&gt;&gt;</code></p>
<h3 id="为何封装，如何封装"><a href="#为何封装，如何封装" class="headerlink" title="为何封装，如何封装"></a>为何封装，如何封装</h3><h4 id="1-为何封装："><a href="#1-为何封装：" class="headerlink" title="1. 为何封装："></a>1. 为何封装：</h4><ul>
<li>写<code>new TypeToken&lt;XXX&gt;(){}</code> 麻烦，IDE格式化后还不好看</li>
<li>不同的地方每进行一次 <code>new TypeToken&lt;XXX&gt;(){}</code> 操作都会生成一个新的类</li>
<li>对于任意类<code>XXX</code>都只有两种情况<code>new TypeToken&lt;Result&lt;XXX&gt;&gt;(){}</code>和<code>new TypeToken&lt;Result&lt;List&lt;XXX&gt;&gt;&gt;(){}</code></li>
<li>方便统一管理</li>
</ul>
<h4 id="2-如何封装"><a href="#2-如何封装" class="headerlink" title="2. 如何封装"></a>2. 如何封装</h4><p>从上面的我们可以知道，最简单的方法就是提供两个方法分别对应<code>data</code>为Array和Object的情况并接收一个参数，即告知XXX的类型，自动将完成<code>new TypeToken&lt;XXX&gt;(){}</code>与<code>new TypeToken&lt;Result&lt;List&lt;XXX&gt;&gt;&gt;(){}</code>的过程。</p>
<p><strong>方法原型：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 处理 data 为 object 的情况</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">Result&lt;T&gt; <span class="title">fromJsonObject</span><span class="params">(Reader reader, Class&lt;T&gt; clazz)</span> </span>&#123;&#125;</div><div class="line"><span class="comment">// 处理 data 为 array 的情况</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;List&lt;T&gt;&gt; fromJsonArray(Reader reader, Class&lt;T&gt; clazz)&#123;&#125;</div></pre></td></tr></table></figure>
<h3 id="为何失败"><a href="#为何失败" class="headerlink" title="为何失败?"></a>为何失败?</h3><p>对于那些尝试着封装过的人可能都这么写过：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;List&lt;T&gt;&gt; fromJsonArray(Reader reader) &#123;</div><div class="line">    Type type = <span class="keyword">new</span> TypeToken&lt;Result&lt;List&lt;T&gt;&gt;&gt;()&#123;&#125;.getType();</div><div class="line">    <span class="keyword">return</span> GSON.fromJson(reader, type);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当然上面的写法肯定是没有办法完成的，虽然代码不会报错，但运行结果肯定是不对的，因为这里的<code>T</code> 其实是一个 <code>TypeVariable</code>，他在运行时并不会变成我们想要的XXX，所以通过<code>TypeToken</code> 得到的 泛型信息只是 <code>&quot;Result&lt;List&lt;T&gt;&gt;&quot;</code>。</p>
<h3 id="如何解决"><a href="#如何解决" class="headerlink" title="如何解决?"></a>如何解决?</h3><p>既然TypeToken的作用是用于获取泛型的类，返回的类型为<code>Type</code>，真正的泛型信息就是放在这个<code>Type</code>里面，既然用TypeToken生成会有问题,那我们自己生成Type就行了嘛。</p>
<p>Type是Java中所有类型的父接口，在1.8以前是一个空接口，自1.8起多了个<code>getTypeName()</code>方法，下面有<code>ParameterizedType</code>、 <code>GenericArrayType</code>、 <code>WildcardType</code>、 <code>TypeVariable</code> 几个接口，以及<code>Class</code>类。这几个接口在本次封装过程中只会用到 <code>ParameterizedType</code> ，所以简单说一下：</p>
<p><code>ParameterizedType</code> 简单说来就是形如“ <strong>类型&lt;&gt;</strong> ”的类型，如:<code>Map&lt;String,User&gt;</code>。下面就以 <code>Map&lt;String,User&gt;</code> 为例讲一下里面各个方法的作用。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ParameterizedType</span> <span class="keyword">extends</span> <span class="title">Type</span> </span>&#123;</div><div class="line">     <span class="comment">// 返回Map&lt;String,User&gt;里的String和User，所以这里返回[String.class,User.clas]</span></div><div class="line">    Type[] getActualTypeArguments(); </div><div class="line">    <span class="comment">// Map&lt;String,User&gt;里的Map,所以返回值是Map.class</span></div><div class="line">    <span class="function">Type <span class="title">getRawType</span><span class="params">()</span></span>;</div><div class="line">    <span class="comment">// 用于这个泛型上中包含了内部类的情况,一般返回null</span></div><div class="line">    <span class="function">Type <span class="title">getOwnerType</span><span class="params">()</span></span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>所以，知道了这里需要的泛型是怎么回事，一切都好说了，下面我们来完成之前留下的空方法。</p>
<h4 id="1-实现一个简易的-ParameterizedType"><a href="#1-实现一个简易的-ParameterizedType" class="headerlink" title="1. 实现一个简易的 ParameterizedType"></a>1. 实现一个简易的 ParameterizedType</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParameterizedTypeImpl</span> <span class="keyword">implements</span> <span class="title">ParameterizedType</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Class raw;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Type[] args;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ParameterizedTypeImpl</span><span class="params">(Class raw, Type[] args)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.raw = raw;</div><div class="line">        <span class="keyword">this</span>.args = args != <span class="keyword">null</span> ? args : <span class="keyword">new</span> Type[<span class="number">0</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> Type[] getActualTypeArguments() &#123;</div><div class="line">        <span class="keyword">return</span> args;</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Type <span class="title">getRawType</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> raw;</div><div class="line">    &#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Type <span class="title">getOwnerType</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> <span class="keyword">null</span>;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="2-生成Gson需要的泛型"><a href="#2-生成Gson需要的泛型" class="headerlink" title="2. 生成Gson需要的泛型"></a>2. 生成Gson需要的泛型</h4><h5 id="2-1-解析data是object的情况"><a href="#2-1-解析data是object的情况" class="headerlink" title="2.1 解析data是object的情况"></a>2.1 解析data是object的情况</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">Result&lt;T&gt; <span class="title">fromJsonObject</span><span class="params">(Reader reader, Class&lt;T&gt; clazz)</span> </span>&#123;</div><div class="line">    Type type = <span class="keyword">new</span> ParameterizedTypeImpl(Result.class, <span class="keyword">new</span> Class[]&#123;clazz&#125;);</div><div class="line">    <span class="keyword">return</span> GSON.fromJson(reader, type);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="2-2-解析data是array的情况"><a href="#2-2-解析data是array的情况" class="headerlink" title="2.2 解析data是array的情况"></a>2.2 解析data是array的情况</h5><p>是Array的情况要比是Object的情况多那么一步。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;List&lt;T&gt;&gt; fromJsonArray(Reader reader, Class&lt;T&gt; clazz) &#123;</div><div class="line">    <span class="comment">// 生成List&lt;T&gt; 中的 List&lt;T&gt;</span></div><div class="line">    Type listType = <span class="keyword">new</span> ParameterizedTypeImpl(List.class, <span class="keyword">new</span> Class[]&#123;clazz&#125;);</div><div class="line">    <span class="comment">// 根据List&lt;T&gt;生成完整的Result&lt;List&lt;T&gt;&gt;</span></div><div class="line">    Type type = <span class="keyword">new</span> ParameterizedTypeImpl(Result.class, <span class="keyword">new</span> Type[]&#123;listType&#125;);</div><div class="line">    <span class="keyword">return</span> GSON.fromJson(reader, type);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>本次代码较少，不提供源码</strong></p>
<p><strong>虽然这篇博客是以Gson为例，但从上面的内容可以看出实际上和Gson关系不大，主要的内容还是Java的泛型基础，所以这种封装的方法同样适用于其它的框架。</strong></p>
<p>最后借这次机会给安利一个简易的泛型生成库 <strong>TypeBuilder</strong> ，其最初实现的目的就是让大家快速的生成泛型信息，同时也会作一些参数检查，保证正确性。</p>
<p>用上面的代码给大家举个例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;List&lt;T&gt;&gt; fromJsonArray(Reader reader, Class&lt;T&gt; clazz) &#123;</div><div class="line">    Type type = TypeBuilder</div><div class="line">            .newInstance(Result.class)</div><div class="line">            .beginSubType(List.class)</div><div class="line">            .addTypeParam(clazz)</div><div class="line">            .endSubType()</div><div class="line">            .build();</div><div class="line">    <span class="keyword">return</span> GSON.fromJson(reader, type);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">Result&lt;T&gt; <span class="title">fromJsonObject</span><span class="params">(Reader reader, Class&lt;T&gt; clazz)</span> </span>&#123;</div><div class="line">    Type type = TypeBuilder</div><div class="line">            .newInstance(Result.class)</div><div class="line">            .addTypeParam(clazz)</div><div class="line">            .build();</div><div class="line">    <span class="keyword">return</span> GSON.fromJson(reader, type);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Type"><a href="#Type" class="headerlink" title="Type"></a>Type</h2><p>Type 是 Java 编程语言中所有类型的公共高级接口。它们包括原始类型、参数化类型、数组类型、类型变量和基本类型</p>
<h3 id="ParameterizedType"><a href="#ParameterizedType" class="headerlink" title="ParameterizedType"></a>ParameterizedType</h3><p>ParameterizedType 表示参数化类型，如 Collection<string></string></p>
<table>
<thead>
<tr>
<th style="text-align:left">方法</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Type[ ]  getActualTypeArguments()</td>
<td style="text-align:left">获取真实参数</td>
</tr>
</tbody>
</table>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseProtocol</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line">    ...</div><div class="line">    <span class="comment">// 泛型解析</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> T <span class="title">parsejson</span><span class="params">(String jsonString)</span></span>&#123;</div><div class="line">        ParameterizedType genericSuperclass = (ParameterizedType) getClass().getGenericSuperclass();</div><div class="line">        Type[] args = genericSuperclass.getActualTypeArguments();</div><div class="line">        Type type = args[<span class="number">0</span>];</div><div class="line">        <span class="keyword">return</span> GsonUtil.changeGsonToBean(jsonString,type);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/泛型/" rel="tag"># 泛型</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/04/30/动态代理/" rel="next" title="动态代理">
                <i class="fa fa-chevron-left"></i> 动态代理
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/04/30/volatile关键字解析/" rel="prev" title="volatile关键字解析">
                volatile关键字解析 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/ai.jpg"
               alt="JackChan" />
          <p class="site-author-name" itemprop="name">JackChan</p>
           
              <p class="site-description motion-element" itemprop="description">生活不止眼前的苟且，还有诗和远方！</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">23</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/JackChan1999" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.gitbook.com/@alleniverson" target="_blank" title="GitBook">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  GitBook
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/1848214604?topnav=1&wvr=6&topsug=1&is_all=1" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://blog.csdn.net/axi295309066" target="_blank" title="CSDN">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  CSDN
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-泛型概述"><span class="nav-number">1.</span> <span class="nav-text">1. 泛型概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-泛型的好处"><span class="nav-number">2.</span> <span class="nav-text">2. 泛型的好处</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-类型安全"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 类型安全</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-消除强制类型转换"><span class="nav-number">2.2.</span> <span class="nav-text">2.2  消除强制类型转换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-优化了程序设计，解决了黄色警告线"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 优化了程序设计，解决了黄色警告线</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-泛型的应用"><span class="nav-number">3.</span> <span class="nav-text">3. 泛型的应用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-泛型的内部原理"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 泛型的内部原理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-泛型类"><span class="nav-number">4.</span> <span class="nav-text">4. 泛型类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-泛型方法"><span class="nav-number">5.</span> <span class="nav-text">5. 泛型方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-泛型接口"><span class="nav-number">6.</span> <span class="nav-text">6. 泛型接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-泛型高级-通配符"><span class="nav-number">7.</span> <span class="nav-text">7. 泛型高级(通配符)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#泛型"><span class="nav-number">8.</span> <span class="nav-text">泛型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#泛型类"><span class="nav-number">9.</span> <span class="nav-text">泛型类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#泛型方法"><span class="nav-number">10.</span> <span class="nav-text">泛型方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#泛型的继承和实现"><span class="nav-number">11.</span> <span class="nav-text">泛型的继承和实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#通配符"><span class="nav-number">12.</span> <span class="nav-text">通配符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#类型推断"><span class="nav-number">13.</span> <span class="nav-text">类型推断</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#泛型擦除"><span class="nav-number">14.</span> <span class="nav-text">泛型擦除</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Gson泛型封装"><span class="nav-number">15.</span> <span class="nav-text">Gson泛型封装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#约定"><span class="nav-number">15.1.</span> <span class="nav-text">约定</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为何封装，如何封装"><span class="nav-number">15.2.</span> <span class="nav-text">为何封装，如何封装</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-为何封装："><span class="nav-number">15.2.1.</span> <span class="nav-text">1. 为何封装：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-如何封装"><span class="nav-number">15.2.2.</span> <span class="nav-text">2. 如何封装</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为何失败"><span class="nav-number">15.3.</span> <span class="nav-text">为何失败?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何解决"><span class="nav-number">15.4.</span> <span class="nav-text">如何解决?</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-实现一个简易的-ParameterizedType"><span class="nav-number">15.4.1.</span> <span class="nav-text">1. 实现一个简易的 ParameterizedType</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-生成Gson需要的泛型"><span class="nav-number">15.4.2.</span> <span class="nav-text">2. 生成Gson需要的泛型</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-解析data是object的情况"><span class="nav-number">15.4.2.1.</span> <span class="nav-text">2.1 解析data是object的情况</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2-解析data是array的情况"><span class="nav-number">15.4.2.2.</span> <span class="nav-text">2.2 解析data是array的情况</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Type"><span class="nav-number">16.</span> <span class="nav-text">Type</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ParameterizedType"><span class="nav-number">16.1.</span> <span class="nav-text">ParameterizedType</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">JackChan</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://yoursite.com/2017/04/30/泛型/';
          this.page.identifier = '2017/04/30/泛型/';
          this.page.title = '泛型';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  





  





  






  





  

  

  

  

  

</body>
</html>
